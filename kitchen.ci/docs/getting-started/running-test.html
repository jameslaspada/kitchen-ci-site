<html lang=en> <!--[if lt IE 7]>html.no-js.lt-ie9.lt-ie8.lt-ie7 lang="en"<![endif]--> <!--[if IE 7]>html.no-js.lt-ie9.lt-ie8 lang="en"<![endif]--> <!--[if IE 8]>html.no-js.lt-ie9 lang="en"<![endif]--> <!--[if (gte IE 8)]><html class=no-js><![endif]--> 
<!-- Mirrored from kitchen.ci/docs/getting-started/running-test by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 17 Aug 2015 23:12:38 GMT -->
<head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <title> Running Kitchen Test - KitchenCI </title> <meta content='Test Kitchen' name=description> <meta content='Fletcher Nichol' name=author> <meta content='width=device-width, initial-scale=1.0' name=viewport> <link href="../../css/kitchen-26ac5aa6.css" media=screen rel=stylesheet /> <link href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700" media=screen rel=stylesheet /> <link href="http://fonts.googleapis.com/css?family=Open+Sans" media=screen rel=stylesheet /> <link href="http://fonts.googleapis.com/css?family=Inconsolata" media=screen rel=stylesheet /> </head> <body> <!--[if lt IE 7]><p class=browsehappy>You are using an <strong>outdated</strong> browser. Please <a href='//browsehappy.com/'>upgrade your browser</a> to improve your experience.</p><![endif]--> <nav class='navbar navbar-inverse navbar-fixed-top' role=navigation> <div class=container> <div class=navbar-header> <div class='button navbar-toggle' data-target='.navbar-collapse' data-toggle=collapse type=button> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </div> <a class=navbar-brand href="../../index.html">KitchenCI</a> </div> <div class='navbar-collapse collapse'> <ul class='nav navbar-nav'> <li class=''> <a href="../../index.html">Home</a> </li> <li class=''> <a href="../../blog/index.html">Blog</a> </li> <li class=''> <a href="index.html">Guide</a> </li> </ul> <ul class='nav navbar-nav navbar-right' id=contacts> <li> <a href='http://twitter.com/kitchenci'> <i class='fa fa-twitter'></i> </a> </li> <li> <a href='http://github.com/test-kitchen'> <i class='fa fa-github'></i> </a> </li> </ul> </div> </div> </nav> <div class=welcomewrap> <h1>Getting Started Guide</h1> </div> <div class=progress> <div aria-valuemax=100 aria-valuemin=0 aria-valuenow=guide_progress class=progress-bar role=progressbar style='width: 45.0%;'> <span class=sr-only id='45.0% Complete'></span> </div> </div> <div class='container guide'> <div class=row> <div class='article col-sm-8 col-md-8'> <div class=callout> <p> <strong>Previously:</strong> <a href='running-verify.html'>Running Kitchen Verify</a> </p> </div> <span id=githubs> <h2>Running Kitchen Test</h2> <a href='http://github.com/test-kitchen/kitchen-docs/edit/master/source/docs/getting-started/running-test.md'> <div class='glyphicon glyphicon-pencil'></div> </a> </span> <p>Now it's time to introduce to the <strong>test</strong> meta-action which helps you automate all the previous actions so far into one command. Recall that we currently have our instance in a "verified" state. With this in mind, let's run <code>kitchen test</code>:</p>&#x000A;&#x000A;<pre class="highlight plaintext">$ kitchen test default-ubuntu-1204&#x000A;-----&gt; Starting Kitchen (v1.0.0)&#x000A;-----&gt; Cleaning up any prior instances of &lt;default-ubuntu-1204&gt;&#x000A;-----&gt; Destroying &lt;default-ubuntu-1204&gt;...&#x000A;       [default] Forcing shutdown of VM...&#x000A;       [default] Destroying VM and associated drives...&#x000A;       Vagrant instance &lt;default-ubuntu-1204&gt; destroyed.&#x000A;       Finished destroying &lt;default-ubuntu-1204&gt; (0m3.06s).&#x000A;-----&gt; Testing &lt;default-ubuntu-1204&gt;&#x000A;-----&gt; Creating &lt;default-ubuntu-1204&gt;...&#x000A;       Bringing machine 'default' up with 'virtualbox' provider...&#x000A;       [default] Importing base box 'opscode-ubuntu-12.04'...&#x000A;       [default] Matching MAC address for NAT networking...&#x000A;       [default] Setting the name of the VM...&#x000A;       [default] Clearing any previously set forwarded ports...&#x000A;       [default] Creating shared folders metadata...&#x000A;       [default] Clearing any previously set network interfaces...&#x000A;       [default] Preparing network interfaces based on configuration...&#x000A;       [default] Forwarding ports...&#x000A;       [default] -- 22 =&gt; 2222 (adapter 1)&#x000A;       [default] Running 'pre-boot' VM customizations...&#x000A;       [default] Booting VM...&#x000A;       [default] Waiting for machine to boot. This may take a few minutes...&#x000A;[default] Machine booted and ready!       [default] Setting hostname...&#x000A;       [default] Mounting shared folders...&#x000A;       Vagrant instance &lt;default-ubuntu-1204&gt; created.&#x000A;       Finished creating &lt;default-ubuntu-1204&gt; (0m46.22s).&#x000A;-----&gt; Converging &lt;default-ubuntu-1204&gt;...&#x000A;       Preparing files for transfer&#x000A;       Preparing current project directory as a cookbook&#x000A;       Removing non-cookbook files before transfer&#x000A;-----&gt; Installing Chef Omnibus (true)&#x000A;       downloading https://www.opscode.com/chef/install.sh&#x000A;         to file /tmp/install.sh&#x000A;       trying wget...&#x000A;Downloading Chef  for ubuntu...&#x000A;Installing Chef&#x000A;Selecting previously unselected package chef.&#x000A;(Reading database ... 53291 files and directories currently installed.)&#x000A;Unpacking chef (from .../tmp.CLdJIw55/chef__amd64.deb) ...&#x000A;Setting up chef (11.8.0-1.ubuntu.12.04) ...&#x000A;Thank you for installing Chef!&#x000A;       Transfering files to &lt;default-ubuntu-1204&gt;&#x000A;[2013-11-30T22:10:59+00:00] INFO: Forking chef instance to converge...&#x000A;Starting Chef Client, version 11.8.0&#x000A;[2013-11-30T22:10:59+00:00] INFO: *** Chef 11.8.0 ***&#x000A;[2013-11-30T22:10:59+00:00] INFO: Chef-client pid: 1192&#x000A;[2013-11-30T22:10:59+00:00] INFO: Setting the run_list to ["recipe[git::default]"] from JSON&#x000A;[2013-11-30T22:10:59+00:00] INFO: Run List is [recipe[git::default]]&#x000A;[2013-11-30T22:10:59+00:00] INFO: Run List expands to [git::default]&#x000A;[2013-11-30T22:10:59+00:00] INFO: Starting Chef Run for default-ubuntu-1204&#x000A;[2013-11-30T22:10:59+00:00] INFO: Running start handlers&#x000A;[2013-11-30T22:10:59+00:00] INFO: Start handlers complete.&#x000A;Compiling Cookbooks...&#x000A;Converging 2 resources&#x000A;Recipe: git::default&#x000A;  * package[git] action install[2013-11-30T22:10:59+00:00] INFO: Processing package[git] action install (git::default line 1)&#x000A;&#x000A;    - install version 1:1.7.9.5-1 of package git&#x000A;&#x000A;  * log[Well, that was too easy] action write[2013-11-30T22:11:24+00:00] INFO: Processing log[Well, that was too easy] action write (git::default line 3)&#x000A;[2013-11-30T22:11:24+00:00] INFO: Well, that was too easy&#x000A;&#x000A;&#x000A;[2013-11-30T22:11:24+00:00] INFO: Chef Run complete in 24.365178204 seconds&#x000A;[2013-11-30T22:11:24+00:00] INFO: Running report handlers&#x000A;[2013-11-30T22:11:24+00:00] INFO: Report handlers complete&#x000A;Chef Client finished, 2 resources updated&#x000A;       Finished converging &lt;default-ubuntu-1204&gt; (0m45.17s).&#x000A;-----&gt; Setting up &lt;default-ubuntu-1204&gt;...&#x000A;Fetching: thor-0.18.1.gem (100%)&#x000A;Fetching: busser-0.6.0.gem (100%)&#x000A;Successfully installed thor-0.18.1&#x000A;Successfully installed busser-0.6.0&#x000A;2 gems installed&#x000A;-----&gt; Setting up Busser&#x000A;       Creating BUSSER_ROOT in /tmp/busser&#x000A;       Creating busser binstub&#x000A;       Plugin bats installed (version 0.1.0)&#x000A;-----&gt; Running postinstall for bats plugin&#x000A;      create  /tmp/bats20131130-4164-uxjzr4/bats&#x000A;      create  /tmp/bats20131130-4164-uxjzr4/bats.tar.gz&#x000A;Installed Bats to /tmp/busser/vendor/bats/bin/bats&#x000A;      remove  /tmp/bats20131130-4164-uxjzr4&#x000A;       Finished setting up &lt;default-ubuntu-1204&gt; (0m4.89s).&#x000A;-----&gt; Verifying &lt;default-ubuntu-1204&gt;...&#x000A;       Suite path directory /tmp/busser/suites does not exist, skipping.&#x000A;Uploading /tmp/busser/suites/bats/git_installed.bats (mode=0644)&#x000A;-----&gt; Running bats test suite&#x000A; ✓ git binary is found in PATH&#x000A;&#x000A;       1 test, 0 failures&#x000A;&#x000A;       Finished verifying &lt;default-ubuntu-1204&gt; (0m0.98s).&#x000A;-----&gt; Destroying &lt;default-ubuntu-1204&gt;...&#x000A;       [default] Forcing shutdown of VM...&#x000A;       [default] Destroying VM and associated drives...&#x000A;       Vagrant instance &lt;default-ubuntu-1204&gt; destroyed.&#x000A;       Finished destroying &lt;default-ubuntu-1204&gt; (0m3.48s).&#x000A;       Finished testing &lt;default-ubuntu-1204&gt; (1m43.82s).&#x000A;-----&gt; Kitchen is finished. (1m44.11s)&#x000A;</pre>&#x000A;<p>There's only one remaining action left that needs a mention: the <strong>Destroy Action</strong> which… destroys the instance. With this in mind, here's what Test Kitchen is doing in the <strong>Test Action</strong>:</p>&#x000A;&#x000A;<ol>&#x000A; <li>Destroys the instance if it exists (<code>Cleaning up any prior instances of &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A; <li>Creates the instance (<code>Creating &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A; <li>Converges the instance (<code>Converging &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A; <li>Sets up Busser and runner plugins on the instance (<code>Setting up &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A; <li>Verifies the instance by running Busser tests (<code>Verifying &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A; <li>Destroys the instance (<code>Destroying &lt;default-ubuntu-1204&gt;</code>)</li>&#x000A;</ol>&#x000A;&#x000A;<p>A few details with regards to test:</p>&#x000A;&#x000A;<ul>&#x000A; <li>Test Kitchen will abort the run on the instance at the first sign of trouble. This means that if your Chef run fails then Busser won't be installed and the instance won't be destroyed. This gives you a chance to inspect the state of the instance and fix any issues.</li>&#x000A; <li>The behavior of the final destroy action can be overridden if desired. Check out the documentation for the <code>--destroy</code> flag using <code>kitchen help test</code>.</li>&#x000A; <li>The primary use case in mind for this meta-action is in a Continuous Integration environment or a command for developers to run before check in or after a fresh clone. If you're using this in your test-code-verify development cycle it's going to quickly become very slow and frustrating. You're better off running the <strong>converge</strong> and <strong>verify</strong> subcommands in development and save the <strong>test</strong> subcommand when you need to verify the end-to-end run of your code.</li>&#x000A;</ul>&#x000A;&#x000A;<p>Finally, let's check the status of the instance:</p>&#x000A;&#x000A;<pre class="highlight plaintext">$ kitchen list&#x000A;Instance             Driver   Provisioner  Last Action&#x000A;default-ubuntu-1204  Vagrant  ChefSolo     &lt;Not Created&gt;&#x000A;</pre>&#x000A;<p>Back to square one.</p>&#x000A;&#x000A; <hr> <div id=suggestions> <div class=row> <div class='col-sm-7 col-md-7 pull-left'> <p></p> </div> <div class='col-sm-5 col-md-5 pull-right'> <div class='maximum-button red full-width'> <a href='adding-platform.html'>Adding a Platform</a> <i class='glyphicon glyphicon-circle-arrow-right'></i> </div> </div> </div> </div> </div> <div class='col-sm-4 col-md-4'> <ul class=sections> <li> <a href='index.html'>Introduction</a> </li> <li> <a href='installing.html'>Installing Test Kitchen</a> </li> <li> <a href='getting-help.html'>Getting Help</a> </li> <li> <a href='creating-cookbook.html'>Creating a Cookbook</a> </li> <li> <a href='writing-recipe.html'>Writing a Recipe</a> </li> <li> <a href='running-converge.html'>Running Kitchen Converge</a> </li> <li> <a href='manually-verifying.html'>Manually Verifying</a> </li> <li> <a href='writing-test.html'>Writing a Test</a> </li> <li> <a href='running-verify.html'>Running Kitchen Verify</a> </li> <li class=bookmark> <i class='glyphicon glyphicon-bookmark'></i> <p>Running Kitchen Test</p> </li> <li> <a href='adding-platform.html'>Adding a Platform</a> </li> <li> <a href='dynamic-configuration.html'>Dynamic Configuration</a> </li> <li> <a href='fixing-converge.html'>Fixing Converge</a> </li> <li> <a href='adding-feature.html'>Adding a New Feature</a> </li> <li> <a href='adding-suite.html'>Adding a Suite</a> </li> <li> <a href='writing-server-test.html'>Writing a Server Test</a> </li> <li> <a href='writing-failing-recipe.html'>Writing a Failing Recipe</a> </li> <li> <a href='adding-dependency.html'>Adding a Dependency</a> </li> <li> <a href='backfilling-platforms.html'>Backfilling Platforms</a> </li> <li> <a href='next-steps.html'>Next Steps</a> </li> </ul> </div> </div> </div> </body> <script src="../../js/vendor/modernizr-2.6.2.min-76c5a590.js"></script> <script src="../../js/all-126c4e27.js"></script> <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-39138312-3', 'kitchen.ci');
    ga('send', 'pageview');
  </script> 
<!-- Mirrored from kitchen.ci/docs/getting-started/running-test by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 17 Aug 2015 23:12:38 GMT -->
</html>